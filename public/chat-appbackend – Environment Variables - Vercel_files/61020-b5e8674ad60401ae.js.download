(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61020],{161020:function(e,n,t){"use strict";t.d(n,{hW:function(){return C},Tb:function(){return O},_0:function(){return S}});var r=t(397458),o=t(652983),i=t(68839),l=t(9055),c=t(588875),a=t(557385),s=t(306054),d=t(684624),u=t(583539),p=t(307818),v=t(66818),j=t(502383),x=t(457984),h=t(256766),f=t(150258),m=t(798561),g=t(121930),_=t(131555),P=t(260372),w=t(375599);function y(e){var n,t;let{isLoading:o,advancedOptions:c,onChangeAdvancedOptions:a,prefixPlaceholder:s,sampleEnvVarName:d}=e;return(0,r.jsxs)(i.K,{gap:6,children:[(0,r.jsx)(P.Q,{environments:c.environments,error:null===(n=c.error)||void 0===n?void 0:n.environments,onChange:e=>a({...c,environments:e,error:{...c.error,environments:void 0}})}),(0,r.jsx)(w.j,{isExpandedDefault:!!c.error,children:(0,r.jsxs)(i.K,{gap:3,children:[(0,r.jsx)(_.I,{"aria-label":"Environment Variables Prefix",disabled:o,error:null===(t=c.error)||void 0===t?void 0:t.envPrefix,label:"Environment Variables Prefix",onChange:e=>a({...c,envPrefix:e.currentTarget.value,error:{...c.error,envPrefix:void 0}}),placeholder:s,suffix:d,value:c.envPrefix,width:"100%"}),(0,r.jsx)(l.x,{color:"gray-900",children:"This prefix will be applied to the environment variables that are automatically created for the project."})]})})]})}function O(e){let{project:n,storeId:t,title:l,subtitle:a,onClickOutside:f,onConnectionCreated:g,ProjectSelector:_,storeType:P,initialEnvPrefix:w}=e,{mutate:O}=(0,p.i)(),{createConnection:C}=(0,h.v)({storeType:P}),[S,b]=(0,o.useState)({envPrefix:w??m.ef[P],environments:{[j.r.Development]:!0,[j.r.Preview]:!0,[j.r.Production]:!0},error:null}),[I,E]=(0,o.useState)(!1),[k,D]=(0,o.useState)(null),K=(0,x.Z)(n);(0,o.useEffect)(()=>{null!==S.error&&(!n||K&&n.id!==K.id)&&b({...S,error:null})},[S,K,n]);let Z=(0,o.useCallback)(async e=>{if(e.preventDefault(),n)try{let e=[j.r.Production,j.r.Preview,j.r.Development].filter(e=>S.environments[e]);if(E(!0),D(null),b({...S,error:null}),0===e.length){b({...S,error:{environments:"Select at least one Environment for your Environment Variable"}}),E(!1);return}if(!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(S.envPrefix)){b({...S,error:{envPrefix:"The prefix contains invalid characters. It must start with a letter and be made of letters, digits, and underscores only."}}),E(!1);return}await C({projectId:n.id,envVarPrefix:S.envPrefix,envVarEnvironments:e,storeId:t,type:P}),v.Vy.success(`Connected Project ${n.name} to ${m.Z[P]}`),await O(),g&&await g(),f()}catch(e){if(e instanceof Error){let n="project_env_var_not_unique"===e.code;n?b({...S,error:{envPrefix:e.message}}):D(e.message)}else throw e}finally{E(!1)}},[n,S,C,t,P,O,g,f]);return(0,r.jsxs)("form",{onSubmit:(0,u._)(Z),children:[(0,r.jsx)(c.Body,{children:(0,r.jsxs)(i.K,{gap:6,children:[(0,r.jsxs)(i.K,{gap:2,children:[(0,r.jsx)(c.Title,{center:!0,children:l}),a?(0,r.jsx)(c.Subtitle,{children:a}):null]}),(0,r.jsx)(c.Inset,{last:!0,children:(0,r.jsxs)(i.K,{gap:6,children:[_,(0,r.jsx)(y,{advancedOptions:S,isLoading:I,onChangeAdvancedOptions:b,prefixPlaceholder:m.ef[P],sampleEnvVarName:m.CO[P]}),k?(0,r.jsx)(s.Z,{children:k}):null]})})]})}),(0,r.jsxs)(c.Actions,{children:[(0,r.jsx)(c.Action,{onClick:f,type:"secondary",children:"Cancel"}),(0,r.jsx)(c.Action,{buttonType:"submit","data-testid":(0,d.C)(`connect-${P}-project`,"store-modal-connect-project"),disabled:!n,loading:I,children:"Connect"})]})]})}function C(e){let{active:n,store:t,storeType:i,onClickOutside:l,onAnimationDone:s}=e,[d,u]=(0,o.useState)(null),{team:p,user:v}=(0,a.Z)(),j=p?p.slug:null==v?void 0:v.username;return(0,r.jsx)(c.Modal,{active:n,allowOverflow:!0,onAnimationDone:s,onClickOutside:l,width:540,children:(0,r.jsx)(O,{ProjectSelector:(0,r.jsx)(f.l,{account:j,allowSelectConnectedProjects:!1,connectedProjectIds:(null==t?void 0:t.projectsMetadata.map(e=>e.projectId))??[],onProjectSelected:e=>{u(e)},selectedProject:d}),onClickOutside:l,project:d,storeId:(null==t?void 0:t.id)??"",storeType:i,title:"Connect Project"})})}function S(e){let{active:n,store:t,storeType:o,onClickOutside:a,onAnimationDone:s,project:d}=e;return(0,r.jsx)(c.Modal,{active:n,allowOverflow:!0,onAnimationDone:s,onClickOutside:a,width:540,children:(0,r.jsx)(O,{onClickOutside:a,project:d,storeId:(null==t?void 0:t.id)??"",storeType:o,subtitle:(0,r.jsxs)(i.K,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,r.jsx)(l.x,{color:"gray-900",children:"Connect to"}),(0,r.jsx)(g.V,{size:"small",type:o,useColor:!0}),(0,r.jsx)(l.x,{color:"gray-1000",weight:500,children:t&&"name"in t?t.name:null})]}),title:`Configure ${(null==d?void 0:d.name)??""}`})})}},375599:function(e,n,t){"use strict";t.d(n,{j:function(){return u}});var r=t(397458),o=t(652983),i=t(496511),l=t(68839),c=t(9055),a=t(14517),s=t(378049),d=t.n(s);function u(e){let{children:n,isExpandedDefault:t}=e,[s,u]=(0,o.useState)(t);return(0,o.useEffect)(()=>{t&&u(t)},[t]),(0,r.jsxs)(l.K,{className:(0,a.W)(s&&d().advancedOptionsWrapperExpanded),children:[(0,r.jsxs)("div",{"aria-label":"Advanced Options",className:d().advancedOptionsButton,onClick:e=>{e.preventDefault(),u(e=>!e)},onKeyDown:e=>{("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),u(e=>!e))},role:"button",tabIndex:0,children:[(0,r.jsx)(i._,{color:"var(--accents-5)",size:20,style:{transition:"transform 200ms ease",transform:s?"rotate(90deg)":"rotate(0deg)"}}),(0,r.jsx)(c.x,{color:"gray-900",size:13,weight:500,children:"Advanced Options"})]}),s?(0,r.jsx)(l.K,{className:d().advancedOptionsExpanded,children:n}):null]})}},260372:function(e,n,t){"use strict";t.d(n,{Q:function(){return d}});var r=t(397458),o=t(68839),i=t(9055),l=t(760093),c=t(136566),a=t(306054),s=t(502383);function d(e){let{environments:n,error:t,onChange:d}=e;return(0,r.jsx)(c.Z,{value:"Environments",children:(0,r.jsxs)(o.K,{gap:3,children:[(0,r.jsx)(i.x,{color:"gray-900",lineHeight:16,size:13,children:"Choose which environments of the project to make this store available to."}),(0,r.jsxs)(o.K,{direction:"row",gap:4,children:[(0,r.jsx)(l.X,{checked:n[s.r.Production],onChange:()=>{d({...n,[s.r.Production]:!n[s.r.Production]})},children:"Production"}),(0,r.jsx)(l.X,{checked:n[s.r.Preview],onChange:()=>{d({...n,[s.r.Preview]:!n[s.r.Preview]})},children:"Preview"}),(0,r.jsx)(l.X,{checked:n[s.r.Development],onChange:()=>{d({...n,[s.r.Development]:!n[s.r.Development]})},children:"Development"})]}),t?(0,r.jsx)(a.Z,{children:t}):null]})})}},150258:function(e,n,t){"use strict";t.d(n,{l:function(){return f}});var r=t(397458),o=t(652983),i=t(214633),l=t.n(i),c=t(68839),a=t(9055),s=t(496952),d=t(842140),u=t(284997),p=t(601679),v=t(886847),j=t(518027),x=t(393294),h=t.n(x);function f(e){var n;let{allowSelectConnectedProjects:t,selectedProject:i,account:x,onProjectSelected:f,...m}=e,[g,_]=(0,o.useState)(""),P=(0,o.useMemo)(()=>l()(_,500),[]),{data:w}=(0,u.ZP)({limit:8,search:g,latestDeployments:null},{},x),y=e=>!!e&&("connectedProjectIds"in m?m.connectedProjectIds.includes(e.id):m.includedInConnectedProjects(e)),O=y(i);return(0,r.jsxs)(c.K,{gap:4,children:[(0,r.jsxs)(p.Z,{filter:e=>e,onChange:e=>{let n=(null==w?void 0:w.projects.find(n=>n.id===e))??null,r=y(n);(!r||t)&&f(n)},onClear:()=>_(""),placeholder:"Select Project",prefixIcon:(null==i?void 0:i.latestDeployments)&&i.latestDeployments.length>0?(0,r.jsx)(j.h,{deploymentId:(null===(n=i.latestDeployments[0])||void 0===n?void 0:n.id)??"",framework:i.framework,size:20}):null,value:(null==i?void 0:i.name)??null,children:[(0,r.jsx)(p.Z.Input,{onChange:e=>P(e.target.value)}),(0,r.jsx)(p.Z.List,{emptyMessage:w?g?`No project found with the name "${g}".`:"No project under this account.":"Loading...",children:null==w?void 0:w.projects.map(e=>{var n,o;let i=y(e);return(0,r.jsxs)(p.Z.Option,{className:h().storeSelectorProjectOption,disabled:i&&!t,value:e.id,children:[(0,r.jsxs)(c.K,{align:"center",direction:"row",gap:2,children:[(0,r.jsx)(j.h,{deploymentId:null===(o=e.latestDeployments)||void 0===o?void 0:null===(n=o[e.latestDeployments.length-1])||void 0===n?void 0:n.id,framework:e.framework,size:20}),(0,r.jsx)(a.x,{weight:600,children:e.name})]}),i?(0,r.jsx)(s.C,{variant:"gray",children:"connected"}):null]},e.id)})})]}),O&&t?(0,r.jsx)(v.Z,{fill:!0,label:!1,type:"secondary",variant:"contrast",children:(0,r.jsxs)(c.K,{direction:"column",children:[(0,r.jsxs)(c.K,{direction:"row",gap:2,children:[(0,r.jsx)(d.k,{className:h().infoIcon,size:20}),(0,r.jsx)(a.x,{color:"gray-1000",lineHeight:24,weight:500,children:"This project has already been connected to this store"})]}),(0,r.jsx)(a.x,{color:"gray-900",children:"To connect it again, use a different Environment Variable Name."})]})}):null]})}},378049:function(e){e.exports={advancedOptionsTitle:"store-advanced-options-expander_advancedOptionsTitle__JBJOQ",advancedOptionsTitleExpanded:"store-advanced-options-expander_advancedOptionsTitleExpanded__lF_wU",advancedOptionsExpanded:"store-advanced-options-expander_advancedOptionsExpanded__Lwtlf",advancedOptionsIcon:"store-advanced-options-expander_advancedOptionsIcon__gml_w",advancedOptionsIconExpanded:"store-advanced-options-expander_advancedOptionsIconExpanded__VPGmh",advancedOptionsWrapperExpanded:"store-advanced-options-expander_advancedOptionsWrapperExpanded__PD2YV",advancedOptionsButton:"store-advanced-options-expander_advancedOptionsButton__Q_jGh"}},393294:function(e){e.exports={storeSelectorProjectOption:"store-project-selector_storeSelectorProjectOption__vXnd9",storeSelectorProjectSelect:"store-project-selector_storeSelectorProjectSelect__H5Jf2",storeSelectorProjectSelectedProject:"store-project-selector_storeSelectorProjectSelectedProject__oZIlk",storeSelectorProjectSelectedXIcon:"store-project-selector_storeSelectorProjectSelectedXIcon__AKyJA",infoIcon:"store-project-selector_infoIcon__gWwNG"}}}]);