(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50969],{848956:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[teamSlug]/[project]/settings/data-cache",function(){return a(546966)}])},99703:function(e,t,a){"use strict";var n=a(397458),r=a(496952),i=a(832191),s=a(14517),l=a(572009),d=a.n(l);t.Z=function(e){let{feedback:t,muted:a,size:l}=e;return(0,n.jsxs)("div",{className:d().betaBadge,children:[(0,n.jsx)(r.C,{className:(0,s.W)(a?d().betaBadgeMuted:null),size:l,variant:a?"gray-subtle":"pink",children:"Beta"}),t?(0,n.jsx)(i.z,{className:d().feedbackButton,onClick:()=>{document.dispatchEvent(new Event("show-feedback"))},size:"small",type:"tertiary",children:"Provide feedback"}):null]})}},192734:function(e,t,a){"use strict";a.d(t,{Z:function(){return h}});var n=a(397458),r=a(904414),i=a.n(r);a(652983);var s=a(68839),l=a(832191),d=a(607974),c=a(135205),o=a(684624),u=a(99703);function h(e){let{title:t,description:a,note:r,error:h,type:g,disabled:x=!1,disabledForBilling:j,onSave:f=null,saveLoading:p=!1,saveDisabled:b=!1,highlightNote:m=!1,beta:v=!1,action:y=null,className:_,children:w,headerNote:C}=e,k=(0,d.B)(x);return(0,n.jsxs)("div",{className:"jsx-20df583c4acadbf9 "+(_||""),children:[(0,n.jsxs)(c.Fieldset,{"data-testid":(0,o.C)("project-settings",t),disabled:k&&void 0===j,type:k||j||"error"!==g?"default":"error",children:[(0,n.jsxs)(c.Content,{disabled:j,children:[(0,n.jsx)(c.Title,{children:(0,n.jsxs)(s.K,{direction:"row",gap:3,style:{flexWrap:"wrap"},children:[(0,n.jsx)(n.Fragment,{children:t}),v?(0,n.jsx)(u.Z,{muted:j}):null,(0,n.jsx)(n.Fragment,{children:C})]})}),(0,n.jsx)(c.Subtitle,{children:a}),w]}),(0,n.jsxs)(c.Footer,{disabled:!1,highlight:j||m,children:[(0,n.jsx)(c.Footer.Status,{children:h?(0,n.jsx)(c.ErrorText,{children:h instanceof Error?h.message:h}):r||null}),!k&&(f||y)?(0,n.jsxs)(c.Footer.Actions,{children:[f?(0,n.jsx)(l.z,{"data-testid":(0,o.C)("project-settings","save"),disabled:k||b,loading:p,onClick:f,size:"small",children:"Save"}):null,y]}):null]})]}),(0,n.jsx)(i(),{id:"20df583c4acadbf9",children:"div.jsx-20df583c4acadbf9:not(:last-of-type){margin-bottom:var(--geist-gap-section)}"})]})}},546966:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return F}});var n=a(397458),r=a(446118),i=a(850240),s=a(652983),l=a(75883),d=a(68839),c=a(9055),o=a(832191),u=a(977169),h=a(245685),g=a(568841),x=a(588875),j=a(566968),f=a(9978),p=a(761891),b=a(927628),m=a(135635),v=a(66818),y=a(921690),_=a(526810),w=a(611648),C=a(539142),k=a(495142),E=a(306054),z=a(384157),B=a(192734),P=a(46905),N=a.n(P);function T(){var e;let[t,a]=(0,s.useState)(!1),[r,l]=(0,s.useState)(null),P=(0,j.ic)(),{team:T,isReady:F}=(0,m.t7)(),I=(0,v.e1)(),{data:K,mutate:M}=(0,b.PY)(P,{apiVersion:"v10"}),{can:D}=(0,p.ZP)(),{loading:S,error:Z,purgeDataCache:O}=function(){let[e,t]=(0,s.useState)({loading:!1,error:null,data:null}),{isReady:a,team:n}=(0,m.t7)();return{...e,purgeDataCache:r=>{let{projectId:i,onSuccess:s,onError:l}=r;if(!a||!i)return;t({data:null,error:null,loading:!0});let d={teamId:null==n?void 0:n.id,projectIdOrName:i},c=`${w.J1}${(0,C.c)(d)}`;(0,k.I)(c,{method:"DELETE"}).then(()=>{t({...e,loading:!1,data:{status:200}}),null==s||s()}).catch(a=>{t({...e,loading:!1,error:a}),null==l||l()})}}}(),{data:$}=(0,f.m)({id:null==K?void 0:K.connectConfigurationId,teamId:null==T?void 0:T.id}),[A,H]=(0,s.useState)(!1),V=!K||!F,L=D(p.aU.Update,p._z.Project),U=!(null==K?void 0:null===(e=K.dataCache)||void 0===e?void 0:e.userDisabled),{value:q}=(0,z.L7)("data-cache-billing-feature"),X=(0,s.useCallback)(async()=>{try{if(!K)return;let e=K.id,t=null==T?void 0:T.id;a(!0),await (0,k.I)(`${(0,w.Ic)(e)}${(0,C.c)({teamId:t})}`,{method:"PATCH",body:{disabled:U},throwOnHTTPError:!0}),await M()}catch(e){if(e instanceof Error){l(e);return}throw e}finally{a(!1)}},[a,l,U,T,K,M]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(x.Modal,{active:A,onClickOutside:()=>H(!1),children:[(0,n.jsx)(x.Body,{children:(0,n.jsxs)(d.K,{gap:4,children:[(0,n.jsxs)(d.K,{gap:4,style:{marginBottom:"24px"},children:[(0,n.jsx)(x.Title,{children:"Purge Data Cache"}),(0,n.jsx)(x.Subtitle,{children:"All data in the cache will be deleted and then re-validated on next request."})]}),(0,n.jsxs)(c.x,{children:["This may cause a ",(0,n.jsx)("strong",{children:"temporary increase"})," in request times for users while new data is re-fetched."]})]})}),(0,n.jsxs)(x.Actions,{children:[(0,n.jsx)(x.Action,{onClick:()=>H(!1),type:"secondary",children:"Cancel"}),(0,n.jsx)(x.Action,{disabled:S,onClick:()=>{O({projectId:null==K?void 0:K.id,onSuccess:()=>{H(!1),I.success("Cache purged successfully.")},onError:()=>{I.error("Cache purge failed.")}})},type:"error",children:"Continue & Purge Everything"})]})]}),(0,n.jsxs)(B.Z,{description:(0,n.jsx)(c.x,{as:"span",color:"gray-900",children:"Manage data and components cached automatically by compatible frameworks when using Serverless and Edge Functions"}),disabled:V,disabledForBilling:(!!V||!L)&&void 0,error:Z,note:(0,n.jsxs)(n.Fragment,{children:["Learn more about\xa0",(0,n.jsx)(y.r,{external:!0,href:"/docs/infrastructure/data-cache",type:"highlight",children:"Data Cache"})]}),saveDisabled:!(!V&&L),saveLoading:S,title:"Data Cache",children:[q?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.K,{align:"center",direction:"row",gap:2,children:[(0,n.jsx)(_.Z,{checked:U,disabled:V||!L||t,onChange:()=>void X(),size:"large"}),(0,n.jsx)(c.x,{children:U?"Enabled":"Disabled"})]}),r?(0,n.jsx)(d.K,{align:"flex-start",direction:"column",gap:2,style:{marginTop:"8px"},children:(0,n.jsx)(E.Z,{error:r})}):null]}):null,(0,n.jsxs)(i.O,{show:V,children:[(0,n.jsx)("div",{className:N().sdzdon,children:(0,n.jsx)("hr",{className:"geist-hr-reset"})}),(0,n.jsx)(d.K,{direction:"column",gap:4,children:(0,n.jsxs)(d.K,{align:"center",direction:"row",gap:1,justify:"space-between",children:[(0,n.jsxs)(d.K,{gap:1,children:[(0,n.jsx)(c.x,{as:"h5",size:16,weight:600,children:"Purge Cache"}),(0,n.jsx)(c.x,{color:"gray-900",size:14,children:"Delete the entire contents of the Data Cache"})]}),(0,n.jsx)(g.Z,{disableTriggers:L,text:"You need additional permissions to purge cache.",children:(0,n.jsx)(o.z,{"aria-label":"Trash can",disabled:V||!L,onClick:()=>H(!0),prefix:(0,n.jsx)(h.r,{}),svgOnly:!0,type:"error",children:"Purge Everything"})})]})}),(0,n.jsx)("div",{className:N().ryoduc,children:(0,n.jsx)("hr",{className:"geist-hr-reset"})}),(0,n.jsx)(d.K,{direction:"column",gap:4,children:(0,n.jsxs)(d.K,{align:"center",direction:"row",gap:1,justify:"space-between",children:[(0,n.jsxs)(d.K,{gap:1,children:[(0,n.jsx)(c.x,{as:"h5",size:16,weight:600,children:"Cache Usage"}),(0,n.jsx)(c.x,{color:"gray-900",size:14,children:"View most requested cached data, hit/miss ratio and more"})]}),(0,n.jsx)(y.r,{className:N().linkButton,href:T?`/dashboard/${T.slug}/usage`:"/dashboard/usage",variant:"highlight",children:(0,n.jsxs)(d.K,{align:"center",direction:"row",gap:2,children:[(0,n.jsx)("span",{children:"View Usage"}),(0,n.jsx)(u.p,{size:16})]})})]})})]})]})]})}var F=(0,a(897831).Z)(function(){let e=(0,r.useRouter)(),{project:t}=e.query,{isReady:a,value:d}=(0,z.xy)();return(0,s.useEffect)(()=>{a&&!d&&e.push(e.asPath.replace("data-cache",""))},[d,a,e]),(0,n.jsxs)(i.O,{show:!a||!d,children:[(0,n.jsx)(l.G,{title:`${t||""} â€“ Data Cache`,titlePostfix:!0}),(0,n.jsx)(T,{})]})})},9978:function(e,t,a){"use strict";a.d(t,{m:function(){return d}});var n=a(353729),r=a(611648),i=a(539142),s=a(495142),l=a(761891);function d(e,t){let{can:a,isLoading:d}=(0,l.ZP)(),c=a(l.aU.Read,l._z.ConnectConfiguration);return(0,n.ZP)(()=>e.id&&e.teamId&&!d&&c?[r.tw,e.id,{teamId:e.teamId}]:null,e=>{let[t,a,n]=e;return(0,s.I)(`${t}/${a}${(0,i.c)(n)}`,{throwOnHTTPError:!0})},t)}},977169:function(e,t,a){"use strict";a.d(t,{p:function(){return r}});var n=a(923390);let r=(0,n.H)('<circle cx="12" cy="12" r="10"/><path d="M12 16l4-4-4-4"/><path d="M8 12h8"/>','<circle cx="12" cy="12" r="10" fill="var(--geist-fill)"/><path d="M12 16l4-4-4-4" fill="none" stroke="var(--geist-stroke)"/><path d="M8 12h8" stroke="var(--geist-stroke)"/>')},245685:function(e,t,a){"use strict";a.d(t,{r:function(){return r}});var n=a(923390);let r=(0,n.H)('<path d="M3 6h18"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>')},572009:function(e){e.exports={betaBadge:"beta-badge_betaBadge__nn52_",betaBadgeMuted:"beta-badge_betaBadgeMuted__VXlGg",feedbackButton:"beta-badge_feedbackButton__Q8_1M"}},46905:function(e){e.exports={linkButton:"data-cache_linkButton__9mCfO",sdzdon:"data-cache_sdzdon__r_1nh",ryoduc:"data-cache_ryoduc__d5FQb"}}},function(e){e.O(0,[4299,63861,24148,98586,85394,38419,59085,49162,81797,10599,97831,49774,92888,40179],function(){return e(e.s=848956)}),_N_E=e.O()}]);