(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9096],{748949:function(e,r,t){"use strict";t.d(r,{Q:function(){return l}});var n=t(397458),i=t(652983),o=t(14517),s=t(806554),a=t.n(s);let l=(0,i.forwardRef)(function(e,r){let{onAction:t,Icon:s,size:l,className:c}=e,d=(0,i.useCallback)(e=>{"Enter"===e.key&&t()},[t]);return(0,n.jsx)("div",{className:a().iconWrapper,onClick:t,onKeyUp:d,ref:r,role:"button",tabIndex:0,children:(0,n.jsx)(s,{className:(0,o.W)(a().icon,c),size:l})})})},611309:function(e,r,t){"use strict";t.d(r,{i:function(){return I}});var n=t(397458),i=t(652983),o=t(68839),s=t(9055),a=t(760093),l=t(131555),c=t(136566),d=t(684624),u=t(588875),h=t(147709),g=t(583539),p=t(335615),f=t(306054),y=t(66818),x=t(307818),m=t(601679),v=t(886847),j=t(291033),w=t(675455),b=t(375599),T=t(798561),R=t(512258),E=t(533046),$=t(97830),P=t.n($);function I(e){let{active:r,createLabel:t="Create",onBack:$,onRedisCreate:I,projectName:C,projectRegion:S}=e,{createRedis:K}=(0,h.EH)(),{isNameTaken:_}=(0,x.i)(),[k,O]=(0,w.t)({projectName:C,storeType:"redis"}),[B,D,{projectRegionLabel:Z,shouldShowProjectRegionWarning:H}]=(0,R.xb)(h.DP,S),[z,A]=(0,i.useState)([]),[L,U]=(0,i.useState)(!1),[N,q]=(0,i.useState)(!1),[J,V]=(0,i.useState)(null),W=(0,i.useCallback)(async e=>{if(e.preventDefault(),_(k)){V("This name is already in use by another store");return}V(null),q(!0);try{let e=await K({name:k,eviction:L,primaryRegion:B,readRegions:z.map(e=>e.value)});await I(e.store),y.Vy.success(`Created ${T.eD.redis} successfully`),j.co.track(j.s6.KV_STORE_CREATE,{ownerId:e.store.ownerId,name:k,eviction:L,region:B,readRegionCount:z.length})}catch(e){e instanceof Error?V(e.message):V(`An error occurred while creating the ${T.eD.redis}`)}finally{q(!1)}},[K,L,_,k,I,B,z]),F=(0,i.useRef)(null);return(0,i.useEffect)(()=>{setTimeout(()=>{if(r){var e,t;null===(e=F.current)||void 0===e||e.focus(),null===(t=F.current)||void 0===t||t.select()}},0)},[r]),(0,n.jsxs)("form",{onSubmit:(0,g._)(W),children:[(0,n.jsx)(u.Body,{children:(0,n.jsxs)(o.K,{gap:6,children:[(0,n.jsxs)(o.K,{gap:2,children:[(0,n.jsxs)(u.Title,{center:!0,children:["Create ",T.eD.redis]}),(0,n.jsx)(u.Subtitle,{children:(0,n.jsxs)(o.K,{align:"center",direction:"row",gap:0,justify:"center",children:[(0,n.jsxs)(s.x,{children:["Set up this new ",T.eD.redis]}),(0,n.jsxs)(o.K,{align:"center",direction:"row",gap:1.25,children:[(0,n.jsx)(s.x,{color:"gray-900",children:", powered by "}),(0,n.jsxs)(o.K,{align:"center",direction:"row",gap:1,children:[(0,n.jsx)(p.A,{size:16}),(0,n.jsx)(s.x,{color:"gray-900",children:" Upstash"})]})]})]})})]}),(0,n.jsx)(u.Inset,{last:!0,children:(0,n.jsx)(o.K,{gap:6,children:(0,n.jsxs)(o.K,{gap:5,children:[(0,n.jsx)(l.I,{"aria-label":"Database Name","data-testid":(0,d.C)("input-name","store-redis-modal-create"),disabled:N,label:"Database Name",maxLength:w.$,onChange:e=>O(e.currentTarget.value),placeholder:"database-name",ref:F,value:k,width:"100%"}),(0,n.jsxs)(o.K,{gap:2.5,children:[(0,n.jsx)(c.Z,{value:"Primary region",children:(0,n.jsxs)(m.Z,{clearable:!1,onChange:e=>{e&&!z.some(r=>r.value===e)&&D(e)},placeholder:"Choose region",value:h.DP.getLabel(B),children:[(0,n.jsx)(m.Z.Input,{}),(0,n.jsx)(m.Z.List,{children:h.DP.list.map(e=>(0,n.jsx)(m.Z.Option,{disabled:z.some(r=>r.value===e.providerRegion),value:e.providerRegion,children:(0,n.jsx)(R.qh,{region:e})},e.providerRegion))})]})}),(0,n.jsx)(s.x,{color:"gray-900",lineHeight:12,size:13,children:"This is the region where your writes will take place."})]}),(0,n.jsx)(b.j,{children:(0,n.jsxs)(o.K,{gap:5,children:[(0,n.jsxs)(o.K,{gap:2.5,children:[(0,n.jsx)(s.x,{color:"gray-900",lineHeight:12,size:12,weight:500,children:"Read Regions"}),(0,n.jsx)(E.a,{onReadRegionsChange:A,primaryRegion:B,readRegions:z}),(0,n.jsx)(s.x,{color:"gray-900",lineHeight:12,size:13,children:"These are the regions where your reads will take place."})]}),(0,n.jsx)(c.Z,{value:"Use eviction",children:(0,n.jsx)(o.K,{align:"center",direction:"row",gap:2,children:(0,n.jsx)(a.X,{checked:L,className:P().eviction,id:"eviction",onChange:()=>U(!L),children:(0,n.jsx)(s.x,{color:"gray-1000",size:13,children:"Remove keys when your database reaches the maximum size"})})})})]})}),Z&&H?(0,n.jsxs)(v.Z,{fill:!0,label:"Info",type:"warning",variant:"contrast",children:["You selected"," ",(0,n.jsx)("strong",{className:P().semibold,children:h.DP.getLabel(B)})," ","as your primary database region, but this project's Serverless Functions are running in"," ",(0,n.jsx)("strong",{className:P().semibold,children:Z}),". Using different regions increases latency between your Serverless Functions and your data. Select"," ",(0,n.jsx)("strong",{className:P().semibold,children:Z})," ","as the Primary Region for best results."]}):null]})})}),J?(0,n.jsx)(f.Z,{children:J}):null]})}),(0,n.jsxs)(u.Actions,{children:[(0,n.jsx)(u.Action,{onClick:$,type:"secondary",children:"Go Back"}),(0,n.jsx)(u.Action,{buttonType:"submit","data-testid":(0,d.C)("create-redis-button","store-modal-create"),disabled:""===k.trim(),loading:N,children:t})]})]})}},533046:function(e,r,t){"use strict";t.d(r,{a:function(){return g}});var n=t(397458),i=t(652983),o=t(338859),s=t(68839),a=t(147709),l=t(748949),c=t(601679),d=t(512258),u=t(744596),h=t.n(u);function g(e){let{primaryRegion:r,readRegions:t,onReadRegionsChange:u}=e,g=(0,i.useMemo)(()=>{let e=new Set(t.map(e=>e.value));return r&&e.add(r),a.DP.list.filter(r=>!e.has(r.providerRegion))},[r,t]),p=(0,i.useRef)([]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.Z,{onChange:e=>{e&&u([...t,{value:e}])},placeholder:"Choose regions...",value:null,children:[(0,n.jsx)(c.Z.Input,{}),(0,n.jsx)(c.Z.List,{children:g.map(e=>(0,n.jsx)(c.Z.Option,{value:e.providerRegion,children:(0,n.jsx)(d.qh,{region:e})},e.providerRegion))})]}),t.length>0&&(0,n.jsx)(s.K,{children:t.map((e,r)=>(0,n.jsxs)(s.K,{className:h().selectedRegions,direction:"row",justify:"space-between",children:[(0,n.jsx)(d.qh,{region:a.DP.get(e.value)}),(0,n.jsx)(l.Q,{Icon:o.S,onAction:()=>{var n;u(t.filter(r=>r.value!==e.value)),null===(n=p.current[r-1]??p.current[r+1])||void 0===n||n.focus()},ref:e=>{p.current[r]=e},size:16})]},e.value))})]})}},118433:function(e,r,t){"use strict";t.d(r,{Z:function(){return y}});var n=t(397458),i=t(652983),o=t(68839),s=t(9055),a=t(588875),l=t(684624),c=t(921690),d=t(135635),u=t(384157),h=t(66818),g=t(495142),p=t(611648),f=t(798561);function y(e){var r;let{onContinue:t,onBack:y,storeType:x}=e,{hasRedisEnterprise:m}=(0,u.W0)(),{team:v,isReady:j}=(0,d.t7)(),[w,b]=(0,i.useState)(!1),T=(0,h.e1)(),R="postgres"===x||"blob"===x,E=(0,i.useCallback)(e=>{e.preventDefault(),b(!0);let r=new URLSearchParams;v&&r.set("teamId",v.id);let n=r.toString();(0,g.I)(`${p.nf}/accept-tos${n.length>0?`?${n}`:""}`,{method:"POST",body:JSON.stringify({storeType:x}),throwOnHTTPError:!0}).then(t).catch(()=>{T.error("Failed to acknowledge terms of service for storage")}).finally(()=>b(!1))},[t,T,x,v]);return j?(null==v?void 0:null===(r=v.billing)||void 0===r?void 0:r.plan)!=="enterprise"||m?(0,n.jsxs)("form",{onSubmit:E,children:[(0,n.jsx)(a.Body,{children:(0,n.jsxs)(o.K,{gap:6,children:[(0,n.jsx)(o.K,{gap:2,children:(0,n.jsxs)(a.Title,{children:[f.EJ[x].product,R?" Beta":null]})}),(0,n.jsxs)(o.K,{gap:4,children:[(0,n.jsxs)(s.x,{color:"gray-1000",children:["By clicking Accept, as an authorized representative of your organization you agree: (i) to the terms and conditions of the"," ",(0,n.jsx)(c.r,{href:f.EJ[x].link,rel:"noreferrer",tab:!0,variant:"highlight",children:f.EJ[x].title})," ","that apply to this ",f.eD[x]," product; (ii) you have assessed your compliance needs against the third party provider of this product;",R?" and (iii) you understand the risks of using a Beta product.":" and (iii) you understand the risk(s) of using a product that is not SOC 2 Type II compliant or covered under Vercel’s SOC 2 scope."]}),R?(0,n.jsx)(s.x,{color:"gray-900",children:"* As a Beta product, Vercel Storage options are not SOC 2 Type II compliant or covered under Vercel’s SOC 2 scope."}):null,(0,n.jsx)("div",{children:(0,n.jsx)(c.r,{external:!0,href:function(e){switch(e){case"redis":return`${f.rx.redis.soc2}`;case"postgres":return`${f.rx.postgres.soc2}`;default:throw Error("Store type not supported")}}(x),variant:"highlight",children:"Learn more"})})]})]})}),(0,n.jsxs)(a.Actions,{children:[(0,n.jsx)(a.Action,{onClick:y,type:"secondary",children:"Go Back"}),(0,n.jsx)(a.Action,{buttonType:"submit","data-testid":(0,l.C)(`accept-${x}`,"storage-soc2"),loading:w,children:"Accept"})]})]}):(0,n.jsxs)("form",{onSubmit:E,children:[(0,n.jsx)(a.Body,{children:(0,n.jsxs)(o.K,{gap:6,children:[(0,n.jsx)(o.K,{gap:2,children:(0,n.jsx)(a.Title,{children:"This product is not yet available to Enterprise customers"})}),(0,n.jsx)(o.K,{gap:6,children:(0,n.jsxs)(s.x,{children:[f.EJ[x].product,R?" is currently in beta and":null," is not yet available to Enterprise customers. To find out more, please contact your Vercel account team."]})})]})}),(0,n.jsx)(a.Actions,{children:(0,n.jsx)(a.Action,{fullWidth:!0,onClick:y,type:"secondary",children:"Go Back"})})]}):null}},512258:function(e,r,t){"use strict";t.d(r,{dJ:function(){return c},qh:function(){return u},xb:function(){return d}});var n=t(397458),i=t(652983),o=t(9055),s=t(68839),a=t(227769),l=t.n(a);class c{#e;#r;constructor(e,r){this.list=e.map(e=>({...e,providerRegion:r(e.providerRegion)})),this.#e=this.list.reduce((e,r)=>(e.set(r.key,r),e),new Map),this.#r=this.list.reduce((e,r)=>(e.set(r.providerRegion,r),e),new Map)}getLabel(e){let r=this.#r.get(e);return r?`${r.name} - (${r.key})`:""}get(e){return this.#r.get(e)}getByProjectRegion(e){return this.#e.get(e)}hasProjectRegion(e){return this.#e.has(e)}getDefaultRegion(e){return e&&this.#e.has(e)&&this.list.some(r=>{var t;return r.providerRegion===(null===(t=this.#e.get(e))||void 0===t?void 0:t.providerRegion)})?this.#e.get(e):this.list[0]}}function d(e,r){let[t,n]=(0,i.useState)(()=>e.getDefaultRegion(r).providerRegion),o=(0,i.useMemo)(()=>r?e.getByProjectRegion(r):null,[r,e]),s=!!(r&&t&&o&&o.providerRegion!==t);return[t,n,{projectRegionLabel:o?e.getLabel(o.providerRegion):"",shouldShowProjectRegionWarning:s}]}function u(e){let{region:r}=e;return(0,n.jsxs)(s.K,{align:"center",direction:"row",gap:1,children:[(0,n.jsx)(o.x,{color:"gray-1000",children:(null==r?void 0:r.name)??""}),(0,n.jsx)(o.x,{className:l().regionPill,children:(null==r?void 0:r.key)??""})]})}},147709:function(e,r,t){"use strict";t.d(r,{DP:function(){return h},EH:function(){return g}});var n=t(495142),i=t(611648),o=t(341715),s=t(539142),a=t(798561),l=t(512258),c=t(135635),d=t(307818),u=t(256766);let h=new l.dJ([o.c$,o.Gj,o.Po,o.TE,o.EZ,o.Yw,o.yF,o.Gf],e=>e);function g(e){let{team:r}=(0,c.t7)(),{addStore:t,deleteStore:o}=(0,d.i)(),a=(0,s.c)({teamId:null==r?void 0:r.id}),{permissions:l,routerStoreId:h,...g}=(0,u.v)({storeType:"redis",...e}),p=async()=>{if(!h)throw Error("redisId is not defined");let e=await (0,n.I)(`${i.nf}/stores/redis/${h}${a}`,{method:"DELETE",throwOnHTTPError:!0,returnStatus:!0});return await o(h),e},f=async e=>{let r=await (0,n.I)(`${i.nf}/stores/redis${a}`,{method:"POST",throwOnHTTPError:!0,body:e});return await g.mutate(r,{revalidate:!1}),await t(r.store),r},y=async e=>{if(!h)throw Error("redisId is not defined");let r=await (0,n.I)(`${i.nf}/stores/redis/${h}${a}`,{method:"PUT",throwOnHTTPError:!0,body:{name:e}});return await g.mutate(r,{revalidate:!1}),r},x=async e=>{if(!h)throw Error("redisId is not defined");let r=await (0,n.I)(`${i.nf}/stores/redis/${h}${a}`,{method:"PUT",throwOnHTTPError:!0,body:{eviction:e}});return await g.mutate(r,{revalidate:!1}),r},m=async e=>{if(!h)throw Error("redisId is not defined");let r=await (0,n.I)(`${i.nf}/stores/redis/${h}${a}`,{method:"PUT",throwOnHTTPError:!0,body:{readRegions:e}});return await g.mutate(r,{revalidate:!1}),r};return{...g,deleteRedis:p,createRedis:f,updateName:y,updateReadRegions:m,updateEviction:x,permissions:l,redisId:h,routerStoreId:h}}a.K$,a.K$,a.K$,a.K$},256766:function(e,r,t){"use strict";t.d(r,{v:function(){return u}});var n=t(353729),i=t(446118),o=t(495142),s=t(611648),a=t(539142),l=t(761891),c=t(135635),d=t(799297);function u(e){let{isReady:r,team:t}=(0,c.t7)(),{can:u,isLoading:h}=(0,l.ZP)(),g=(0,i.useRouter)(),p=g.query.storeId??g.query.edgeConfigId,f=g.query.project,{mutate:y}=(0,d.Z)(f,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnMount:!1,revalidateOnReconnect:!1}),x=l._z.Redis;switch(e.storeType){case"redis":x=l._z.Redis;break;case"blob":x=l._z.Blob;break;case"edge-config":x=l._z.EdgeConfig;break;case"postgres":x=l._z.Postgres}let m={read:u(l.aU.List,x),create:u(l.aU.Create,x),remove:u(l.aU.Delete,x),update:u(l.aU.Update,x),isLoading:h},v=(0,a.c)({teamId:null==t?void 0:t.id}),j=(0,n.ZP)(()=>r&&!m.isLoading&&m.read&&p?`${s.nf}/stores/${p}${v}`:null,e=>(0,o.I)(e,{throwOnHTTPError:!0}),e),w=async e=>{let{connectionIds:r,storeId:t}=e;if(!t)throw Error("storeId is not defined");for(let e of r)await (0,o.I)(`${s.nf}/stores/${t}/connections/${e}${v}`,{method:"DELETE",throwOnHTTPError:!0});await j.mutate(),y(void 0,{revalidate:!0,populateCache:!0})},b=async e=>{let{storeId:r,...t}=e;if(!r)throw Error("storeId is not defined");await (0,o.I)(`${s.nf}/stores/${r}/connections${v}`,{method:"POST",throwOnHTTPError:!0,body:t}),await j.mutate(),y(void 0,{revalidate:!0,populateCache:!0})},T=async e=>{let{storeId:r}=e;if(!r)throw Error("storeId is not defined");await (0,o.I)(`${s.nf}/stores/${r}/reset${v}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},throwOnHTTPError:!0}),await j.mutate()},R=async e=>{let{storeId:r,toOwnerId:t}=e;if(!r)throw Error("storeId is not defined");if(!t)throw Error("toOwnerId is not defined");await (0,o.I)(`${s.nf}/stores/${r}/transfer${v}`,{method:"POST",throwOnHTTPError:!0,body:{toOwnerId:t}})};return{...j,permissions:m,removeConnections:w,createConnection:b,resetTokens:T,routerStoreId:p,transferStore:R}}},799297:function(e,r,t){"use strict";t.d(r,{W:function(){return d},Z:function(){return c}});var n=t(353729),i=t(495142),o=t(611648),s=t(539142),a=t(135635),l=t(761891);function c(e,r){let{isReady:t,team:o}=(0,a.t7)(),{can:s,isLoading:c}=(0,l.ZP)(),u=s(l.aU.Read,l._z.ProjectEnvVars),h=e&&t&&!c&&u;return(0,n.ZP)(()=>h?d(e,null==o?void 0:o.id):"",e=>(0,i.I)(e,{throwOnHTTPError:!0}),r)}function d(e,r){return`${(0,o.HJ)("v9")}/${encodeURIComponent(e)}/env${(0,s.c)({teamId:r})}`}},806554:function(e){e.exports={icon:"icon-action_icon__HIMNY",iconWrapper:"icon-action_iconWrapper__DzE7t"}},97830:function(e){e.exports={eviction:"redis-modal-create_eviction__Cq_pZ",semibold:"redis-modal-create_semibold__AniR5"}},744596:function(e){e.exports={selectedRegions:"redis-regions-multi-select_selectedRegions__8nzlr"}},227769:function(e){e.exports={regionPill:"store-regions_regionPill__Rcxbs"}}}]);