(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15487],{888374:function(e,n,t){"use strict";t.d(n,{j:function(){return s}});var l=t(638980);function s(e){let n=function(e){let n=e.split(".").slice(-2).join(".");return(0,l.Q)(n)?"https:":"http:"}(e);return`${n}//${e}`}},978927:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return et}});var l=t(397458),s=t(14517),r=t(652983),i=t(446118),o=t(560152),a=t(68839),c=t(9055),d=t(75883),u=t(200850),j=t(379646),m=t(790937),x=t(592475),p=t(870989),h=t(695464),v=t(574197),f=t(675633),y=t(879248),g=t(604803),I=t(875699),_=t(924045),b=t.n(_),C=t(32869),k=t(445387),w=t(734967),S=t(756642),Z=t(71849),D=t(662098),N=t(640203),P=t(64083),R=t(657496),L=t(398090),E=t(927628),F=t(637161),T=t(135635),M=t(609230),K=t(921690),O=t(608034),V=t(384157),q=t(805535),A=t(477452),B=t(850240),Q=t(539965),W=t(901365),$=t.n(W);let z={production:"Production",preview:"Preview"},G={environment:void 0},H={all:"All Environments",...z};function J(e){let{className:n,target:t,onSelect:i,skeleton:o=!1}=e,[c,d]=(0,r.useState)(!1),u=t??"all",j=(0,r.useCallback)(e=>{i("all"===e?void 0:e)},[i]);return(0,r.useEffect)(()=>{o||d(!0)},[o]),(0,l.jsx)("div",{className:(0,s.W)($().filterEnvironment,n),children:(0,l.jsx)(B.O,{show:!!(o&&!c),children:(0,l.jsxs)(Q.Fe,{children:[(0,l.jsx)(Q.j2,{align:"flex-grow",className:$().button,showChevron:!0,type:"secondary",children:(0,l.jsx)(a.K,{align:"center",direction:"row",flex:1,children:(0,l.jsx)("span",{className:$().label,children:H[u]})})}),(0,l.jsx)(Q.v2,{width:180,children:Object.entries(H).map(e=>{let[n,t]=e,r=u===n;return(0,l.jsxs)(Q.sN,{innerMenuItemClassName:(0,s.W)($().menuItem,r&&$().menuItemSelected),onClick:()=>{j(n)},children:[(0,l.jsx)(a.K,{flex:1,children:(0,l.jsx)("span",{className:$().label,children:t})}),(0,l.jsx)(a.K,{align:"end",flex:0,children:r?(0,l.jsx)(A.J,{size:18}):null})]},n)})})]})})})}function Y(e){return!!e&&Object.keys(z).includes(String(e))}var U=t(742515),X=t(348601),ee=t.n(X);let en=e=>{let{branch:n,onClear:t}=e;return(0,l.jsxs)(g.Z,{className:(0,s.W)(b().entity,b().filled),style:{minHeight:400,alignItems:"center",justifyContent:"center",padding:10},children:[(0,l.jsx)(c.x,{weight:700,children:"No Results"}),(0,l.jsx)(I.L,{y:.5}),(0,l.jsxs)(c.x,{color:"gray-900",children:["No deployments"," ",n?(0,l.jsxs)(l.Fragment,{children:["on the"," ",(0,l.jsx)("span",{style:{padding:3,borderRadius:3,background:"var(--accents-2)"},children:n})," ","branch"]}):""," ","match the current filters."]}),(0,l.jsx)(I.L,{y:.5}),(0,l.jsx)(K.r,{onClick:t,variant:"highlight",children:"Clear Filters"})]})};var et=(0,k.ZP)(function(){var e;let n=(0,i.useRouter)(),t="string"==typeof n.query.project?n.query.project:void 0,{data:s}=(0,M.a)(),{team:c}=(0,T.t7)(),{data:_,error:b}=(0,E.PY)(t,{latestDeployments:1}),{data:k}=(0,F.d)(t),[K,A]=(0,r.useState)(null),{data:B}=(0,R.ZP)(K),[Q,W]=(0,o.v1)("range",o.SS.json()),{selectedStatusItems:$,handleSelectStatusItem:z,clearStatus:H}=(0,D.Lj)(),{modal:X,open:et}=(0,y.Z)(t||null,_),{modal:el,open:es,getPromoteTooltip:er}=(0,f.Z)(t,_),ei=(0,r.useCallback)((e,n)=>{n?es(e):et(e)},[et,es]),{filteredBranch:eo,setFilteredBranch:ea,clearBranch:ec,meta:ed,showBranchFilterBar:eu,showBranchSearchBar:ej}=(0,N.R)({project:_}),em=!!(eo||Object.keys($).length),{value:ex,isReady:ep}=(0,V.Y8)(),eh=ex&&ep,{environment:ev,handleSelect:ef,clear:ey}=function(){let{environmentQuery:e,setEnvironmentQuery:n}=function(){let[e,n]=(0,r.useState)(!1),t=(0,i.useRouter)(),[l,s]=(0,o.v1)("environment",o.SS.string),a=(0,r.useCallback)(e=>{s(Y(e)?e:null)},[s]);return(0,r.useEffect)(()=>{t.isReady&&!e&&n(!0)},[e,t.isReady]),{environmentQuery:e&&Y(l)?l:void 0,setEnvironmentQuery:a}}();(0,r.useEffect)(()=>{e&&l({type:"select",target:e})},[e]);let[t,l]=(0,r.useReducer)((e,t)=>{switch(t.type){case"select":return n(t.target),{...e,environment:t.target};case"clear":return G;default:return e}},G);return{environment:t.environment,clear:()=>{(0,r.startTransition)(()=>{l({type:"clear"})})},handleSelect:e=>{let n=Y(e)?e:void 0;(0,r.startTransition)(()=>l({type:"select",target:n}))}}}(),{deployments:eg,initialDataLoaded:eI,isLoadingMore:e_,isReachingEnd:eb,isEmpty:eC,loadMore:ek,mutate:ew}=(0,L.V)({limit:20,project:_,requireProject:!0,meta:ed,state:(0,D.zK)($),target:eh?ev:void 0,since:(null==Q?void 0:Q.start)?new Date(Q.start).getTime():void 0,until:(null==Q?void 0:Q.end)?new Date(Q.end).getTime():void 0},{refreshInterval:5e3})[1],eS=(0,r.useRef)(new Map);for(let e of eg)eS.current.set(e.uid,e);(0,C.Z)(b);let eZ=(0,P.FA)(_),[eD,eN]=(0,r.useState)(!1),{deployment:eP}=(0,O.s)(null==_?void 0:_.id),{rollbackModal:eR,openRollbackModal:eL,getRollbackTooltip:eE,noRollbackCandidates:eF}=(0,q.b)(_),eT=!_||!eI;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.G,{title:_?`${_.name} â€“ Deployments`:"Deployments",titlePostfix:!0}),eZ?(0,l.jsxs)(g.Z,{wrapper:!0,children:[(0,l.jsx)(I.L,{y:2}),(0,l.jsx)(h.Z,{})]}):null,eR,(0,l.jsxs)(u.Z,{title:"Deployments",children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.K,{direction:{sm:"column",lg:"row"},flex:1,gap:2,children:[ej?(0,l.jsx)(g.Z,{flex:1,children:(0,l.jsx)(S.n,{includeProductionBranch:!0,onSelect:ea,project:_,skeleton:eT,value:eo||""})}):null,(0,l.jsx)(U.Z,{maxValue:new Date,onChange:e=>void W(e),skeleton:eT,value:Q||void 0}),eh?(0,l.jsx)(J,{className:ee().filterDropdown,onSelect:ef,skeleton:eT,target:ev}):null,(0,l.jsx)(D.ZP,{className:ee().filterDropdown,handleSelectStatusItem:z,position:"left",selectedStatusItems:$,skeleton:eT})]}),(0,l.jsx)(I.L,{y:.5}),eu?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.V,{branch:eo,deployments:eg,isLoading:!eI,onClearBranch:ec,project:_}),(0,l.jsx)(I.L,{y:.5})]}):null]}),eZ?(0,l.jsx)(v.Z,{}):eC?em?(0,l.jsx)(en,{branch:eo,onClear:()=>{ec(),H(),ey()}}):(0,l.jsx)(p.a,{hasProjectLink:!!(k&&"type"in k),project:_,scope:(null==c?void 0:c.slug)||(null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.username)||""}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(g.Z,{className:ee().deploymentList,children:[eg.map(e=>(0,l.jsx)(x.I,{deployment:e,deploymentsMap:eS.current,getPromoteTooltip:er,getRollbackTooltip:eE,handleCancelDeployment:e=>A(e.uid),handleClickCreateAlias:()=>eN(!0),isCurrentProductionDeployment:(null==eP?void 0:eP.id)===e.uid,noRollbackCandidates:eF,openRollbackModal:eL,project:_,redeploy:ei},e.uid)),eI?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{}),(0,l.jsx)(x.I,{})]})]}),eb||!eI?null:(0,l.jsx)(j.Z,{loading:e_,onClick:ek})]}),(0,l.jsx)(m.Z,{active:eD,onCancel:()=>eN(!1)}),(0,l.jsx)(w.Z,{active:!!B,deployment:B,onClose:()=>{A(null),ew()},teamId:null==c?void 0:c.id}),X,el]})]})},{active:"Deployments",pageProps:{noIndex:!0}})},895582:function(e,n,t){"use strict";t.d(n,{s:function(){return s}});var l=t(923390);let s=(0,l.H)('<path d="M15 18l-6-6 6-6"/>')},901365:function(e){e.exports={filterEnvironment:"filter-environment_filterEnvironment__M9pL2",button:"filter-environment_button__ej_e_",label:"filter-environment_label__SlTep",menuItem:"filter-environment_menuItem__abxJr",menuItemSelected:"filter-environment_menuItemSelected__0p674"}},348601:function(e){e.exports={deploymentList:"deployments_deploymentList__CGn8e",filterDropdown:"deployments_filterDropdown__VB25C"}}}]);