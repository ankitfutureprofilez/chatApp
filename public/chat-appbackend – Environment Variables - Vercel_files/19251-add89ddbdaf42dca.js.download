(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[19251],{544209:function(e,n,i){"use strict";i.d(n,{S:function(){return B}});var r=i(397458),l=i(9055),a=i(376206),t=i(464544),s=i(583539),o=i(66818),d=i(684624),c=i(652983),u=i(729435),g=i(930880),m=i(850240),h=i(68839),v=i(496952),x=i(572465),j=i(832191),p=i(886847),_=i(212548),b=i(466332),f=i(539965),y=i(951517),D=i(654538),w=i(242399),L=i.n(w);let S=e=>{var n,i;return(null==e?void 0:null===(n=e.sources)||void 0===n?void 0:n.length)===a.mI.length?"All Sources":(null==e?void 0:null===(i=e.sources)||void 0===i?void 0:i.map(e=>{var n;return(null===(n=a.mI.find(n=>n.value===e))||void 0===n?void 0:n.label)||""}).join(", "))??""};function N(e){let{logDrain:n,onRemoveTriggered:i,onTestLogDrain:a,teamSlug:t,canRemoveLogDrain:s}=e,o=(0,c.useMemo)(()=>S(n),[n]),w=(null==n?void 0:n.integrationIcon)?{hash:n.integrationIcon}:{placeholder:!0},N=t&&(null==n?void 0:n.configurationId)?`/dashboard/${t}/integrations/${n.configurationId}`:"",T=(null==n?void 0:n.createdFrom)==="self-served"?n.url:null==n?void 0:n.name,C=(null==n?void 0:n.disabledReason)==="log-drain-high-error-rate"||(null==n?void 0:n.disabledReason)==="disabled-by-admin",I=[];return(null==n?void 0:n.branch)&&I.push(`Branch: ${n.branch}`),(null==n?void 0:n.environment)&&I.push(`Environment: ${(0,y.Z)(n.environment)}`),(0,r.jsxs)(h.K,{direction:"column",children:[(0,r.jsxs)("div",{className:L().logDrainItem,"data-testid":n?(0,d.C)("log-drains","item"):void 0,children:[(null==n?void 0:n.createdFrom)==="integration"?(0,r.jsx)(b.qE,{...w,size:40}):(0,r.jsx)("div",{className:L().iconWrapper,children:(0,r.jsx)(u.T,{color:"var(--accents-5)",size:24})}),(0,r.jsxs)(h.K,{align:"center",direction:"row",gap:2,children:[(0,r.jsx)(l.x,{className:L().url,color:"gray-900",monospace:!0,children:n?T:(0,r.jsx)(m.O,{boxHeight:20,height:16,vcenter:!0,width:200})}),(null==n?void 0:n.status)==="errored"&&(0,r.jsx)(v.C,{variant:"amber-subtle",children:"Warning"}),C?(0,r.jsx)(v.C,{variant:"red-subtle",children:"Stopped"}):null]}),(0,r.jsx)(h.K,{className:L().main,direction:"row",children:(0,r.jsx)(h.K,{gap:2,children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.x,{color:"gray-900",children:["Sources: ",o]}),(0,r.jsxs)(l.x,{color:"gray-900",children:["Delivery Format: ",n.deliveryFormat.toUpperCase()]}),I.length>0?(0,r.jsx)(l.x,{color:"gray-900",children:I.join(", ")}):null,(0,r.jsx)(D.Z,{projectsMetadata:n.projectsMetadata,teamSlug:t})]}):(0,r.jsxs)(h.K,{gap:2,children:[(0,r.jsx)(m.O,{boxHeight:20,height:16,vcenter:!0,width:200}),(0,r.jsx)(m.O,{boxHeight:20,height:16,vcenter:!0,width:200})]})})}),n?(0,r.jsx)(l.x,{className:L().age,color:"gray-900",children:`Added ${(0,_.F6)(Date.now()-n.createdAt,{justNowLabel:"now",suffix:" ago"})}`}):(0,r.jsx)(m.O,{boxHeight:60,height:16,width:100}),s&&(null==n?void 0:n.createdFrom)==="self-served"?(0,r.jsx)(h.K,{align:"center",className:L().remove,direction:"row",gap:1,children:(0,r.jsxs)(f.Fe,{children:[(0,r.jsx)(f.j2,{"aria-label":"Menu",size:"small",svgOnly:!0,variant:"unstyled",children:(0,r.jsx)(g.h,{})}),(0,r.jsxs)(f.v2,{children:[(0,r.jsx)(f.sN,{"data-testid":(0,d.C)("log-drains","delete"),onClick:()=>null==i?void 0:i(n),children:(0,r.jsx)("span",{className:L().deleteLogDrian,children:"Delete"})}),(0,r.jsx)(f.sN,{onClick:()=>null==a?void 0:a(n),children:"Test Log Drain"})]})]})}):null,(null==n?void 0:n.createdFrom)==="integration"?(0,r.jsx)(h.K,{align:"center",className:L().remove,children:N?(0,r.jsx)(x.Z,{className:L().manage,href:N,type:"secondary",children:"Manage"}):null}):null]}),C?(0,r.jsxs)(p.Z,{action:"integration"===n.createdFrom?(0,r.jsx)(x.Z,{href:N,size:"small",type:"error",children:"Reinstall Integration"}):(0,r.jsx)(j.z,{onClick:()=>null==i?void 0:i(n),size:"small",type:"error",children:"Remove Log Drain"}),fill:!0,label:!1,size:"mediumSmall",style:{margin:"0 16px 16px 16px",height:"56px"},type:"error",children:["This"," ","integration"===n.createdFrom?"integration":"Log Drain"," ","disabled-by-admin"===n.disabledReason?"was disabled by admin. Please contact support.":"was stopped due to an 80+ percent error rate."]}):null,(null==n?void 0:n.status)==="errored"&&(0,r.jsxs)(p.Z,{action:"integration"===n.createdFrom?(0,r.jsx)(x.Z,{href:N,size:"small",type:"warning",children:"Reinstall Integration"}):(0,r.jsx)(j.z,{onClick:()=>null==i?void 0:i(n),size:"small",type:"warning",children:"Remove Log Drain"}),fill:!0,label:!1,size:"mediumSmall",style:{margin:"0 16px 16px 16px",height:"56px"},type:"warning",children:["This"," ","integration"===n.createdFrom?"integration":"Log Drain"," ","is experiencing an 80+ percent error rate and will be stopped in 24 hours if it continues"]})]})}var T=i(905839),C=i(588875),I=i(306054),k=i(112112),F=i.n(k);let R=e=>{let{isProjectReady:n,projectId:i}=e,[r,l]=(0,c.useState)(!1),[t,s]=(0,c.useState)(null),[d,u]=(0,c.useState)(null),g=(0,o.e1)(),{deleteLogDrain:m}=(0,a.TV)({projectId:i,enabled:n}),h=(0,c.useCallback)(async()=>{if(t){l(!0);try{let e=await m({id:t.id});if((e.status??404)>=400)throw Error("Log Drain not found");s(null),g.success({text:"Removed Log Drain successfully.",key:"remove-log-drain"})}catch(e){u((0,T.SC)(e))}finally{l(!1)}}},[t,g,m]),v=(0,c.useCallback)(()=>{l(!1),u(null)},[]);return{isRemovingLogDrain:r,logDrainBeingRemoved:t,removeError:d,handleClose:v,handleRemoveLogDrain:h,setLogDrainBeingRemoved:s}};function z(e){let{removeError:n,logDrainBeingRemoved:i,onRemove:a,isRemovingLogDrain:t,onClose:s}=e;return(0,r.jsxs)(C.Modal,{active:!!i,onClickOutside:s,children:[(0,r.jsxs)(C.Body,{children:[(0,r.jsx)("header",{children:(0,r.jsx)(l.x,{align:"center",as:"h1",className:F().modalTitle,size:24,children:"Remove Log Drain"})}),(0,r.jsx)("main",{children:(0,r.jsx)(l.x,{align:"center",children:`The Log Drain ${(null==i?void 0:i.url)??""} will be permanently deleted.
              Are you sure you want to continue?`})}),n?(0,r.jsx)(I.Z,{className:F().errorMessage,error:n}):null]}),(0,r.jsxs)(C.Actions,{children:[(0,r.jsx)(C.Action,{onClick:s,type:"secondary",children:"Cancel"}),(0,r.jsx)(C.Action,{loading:t,onClick:a,children:"Remove"})]})]})}var E=i(191042),O=i.n(E);function B(e){let{EmptyState:n,projectId:i,isProjectReady:c=!0,title:u}=e,{permissions:g,team:m,isLoadingLogDrains:h,logDrainsGroups:v,testLogDrain:x}=(0,a.TV)({projectId:i,enabled:c}),{removeError:j,isRemovingLogDrain:p,logDrainBeingRemoved:_,handleClose:b,handleRemoveLogDrain:f,setLogDrainBeingRemoved:y}=R({projectId:i,isProjectReady:c}),D=(0,o.e1)(),w=async e=>{try{let{url:n,headers:i,sources:r,deliveryFormat:l}=e;await x({url:n,headers:i,sources:r??[],deliveryFormat:l}),D.success("Test log drain sent successfully")}catch(e){D.error("Test log drain failed")}};return h?n?(0,r.jsxs)("div",{className:O().logDrainList,children:[(0,r.jsx)(N,{teamSlug:null}),(0,r.jsx)(N,{teamSlug:null}),(0,r.jsx)(N,{teamSlug:null})]}):null:g.list?(0,r.jsxs)(r.Fragment,{children:[0===v.selfServed.length?n??null:(0,r.jsxs)(r.Fragment,{children:[u?(0,r.jsx)(l.x,{as:"h3",size:20,weight:600,children:u}):null,(0,r.jsx)("div",{className:O().logDrainList,"data-testid":(0,d.C)("log-drains","custom-list"),children:v.selfServed.map(e=>"self-served"===e.createdFrom?(0,r.jsx)(N,{canRemoveLogDrain:g.remove,logDrain:e,onRemoveTriggered:y,onTestLogDrain:(0,s._)(w),teamSlug:(null==m?void 0:m.slug)??null},e.id):null)})]}),v.integrations.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.x,{as:"h3",className:O().logDrainsIntegrationList,size:20,weight:600,children:"Log Drains Integration"}),(0,r.jsx)("div",{className:O().logDrainList,"data-testid":(0,d.C)("log-drains","integration-list"),children:v.integrations.map(e=>"integration"===e.createdFrom?(0,r.jsx)(N,{canRemoveLogDrain:g.remove,logDrain:e,onRemoveTriggered:y,teamSlug:(null==m?void 0:m.slug)??null},e.id):null)})]}),(0,r.jsx)(z,{isRemovingLogDrain:p,logDrainBeingRemoved:_,onClose:()=>{b(),y(null)},onRemove:f,removeError:j})]}):(0,r.jsx)(t._,{resource:"Log Drains",team:m})}},99703:function(e,n,i){"use strict";var r=i(397458),l=i(496952),a=i(832191),t=i(14517),s=i(572009),o=i.n(s);n.Z=function(e){let{feedback:n,muted:i,size:s}=e;return(0,r.jsxs)("div",{className:o().betaBadge,children:[(0,r.jsx)(l.C,{className:(0,t.W)(i?o().betaBadgeMuted:null),size:s,variant:i?"gray-subtle":"pink",children:"Beta"}),n?(0,r.jsx)(a.z,{className:o().feedbackButton,onClick:()=>{document.dispatchEvent(new Event("show-feedback"))},size:"small",type:"tertiary",children:"Provide feedback"}):null]})}},951517:function(e,n,i){"use strict";function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}i.d(n,{Z:function(){return r}})},376206:function(e,n,i){"use strict";i.d(n,{TV:function(){return h},mI:function(){return g},tk:function(){return l}});var r,l,a=i(353729),t=i(652983),s=i(611648),o=i(495142),d=i(539142),c=i(135635),u=i(761891);(r=l||(l={})).JSON="json",r.NDJSON="ndjson";let g=[{label:"Static",value:"static",description:"Requests to static assets like HTML and CSS files"},{label:"External",value:"external",description:"External rewrites to a different domain"},{label:"Edge",value:"edge",description:"Output from Edge Functions like Middleware"},{label:"Build",value:"build",description:"Output from the Build Step"},{label:"Lambda",value:"lambda",description:"Output from Vercel Functions like API Routes"}],m=(e,n)=>{let i=new URLSearchParams;return i.set("limit","20"),i.set("includes[]","project"),e&&i.set("teamId",e),n&&i.set("projectId",n),`${s.NX}?${i.toString()}&includes[]=integration`};function h(e){let{isReady:n,team:i}=(0,c.t7)(),{can:r,isLoading:l}=(0,u.ZP)(),g={list:r(u.aU.List,u._z.LogDrains),create:r(u.aU.Create,u._z.LogDrains),remove:r(u.aU.Delete,u._z.LogDrains),isLoading:l},h=(0,d.c)({teamId:null==i?void 0:i.id}),v=(0,a.ZP)(()=>n&&!g.isLoading&&g.list&&(null==e?void 0:e.enabled)?m(null==i?void 0:i.id,e.projectId):null,e=>(0,o.I)(e,{throwOnHTTPError:!0}),e),x=(0,t.useMemo)(()=>{var e,n;return{selfServed:(null===(e=v.data)||void 0===e?void 0:e.filter(e=>"self-served"===e.createdFrom))??[],integrations:(null===(n=v.data)||void 0===n?void 0:n.filter(e=>"integration"===e.createdFrom))??[]}},[v.data]),j=async e=>{let{id:n}=e,i=await (0,o.I)(`${s.NX}/${n}${h}`,{method:"DELETE",throwOnHTTPError:!0,returnStatus:!0});return await v.mutate(),i},p=async e=>{let{deliveryFormat:n,sources:i,projectIds:r,url:l,headers:a,environment:t,branch:d}=e,c=await (0,o.I)(`${s.NX}/${h}`,{method:"POST",throwOnHTTPError:!0,body:{deliveryFormat:n,sources:i,projectIds:r,url:l,headers:a,environment:t,branch:d}});return await v.mutate(),c},_=async e=>{let{deliveryFormat:n,sources:i,url:r,headers:l}=e;return(0,o.I)(`${s.NX}/sample-test${h}`,{method:"POST",body:{deliveryFormat:n,sources:i,url:r,headers:l},throwOnHTTPError:!0})};return{...v,deleteLogDrain:j,createLogDrain:p,testLogDrain:_,permissions:g,team:i,logDrainsGroups:x,isLoadingLogDrains:!(null==e?void 0:e.enabled)||!n||g.isLoading||g.list&&!v.error&&!v.data,isTeamReady:n}}},242399:function(e){e.exports={logDrainItem:"log-drains-item_logDrainItem___I7Bn",iconWrapper:"log-drains-item_iconWrapper__o_wdZ",reveal:"log-drains-item_reveal__lyoqc",age:"log-drains-item_age__2BFKO",main:"log-drains-item_main__mP9OW",remove:"log-drains-item_remove__iwBw_",manage:"log-drains-item_manage__HRaDk",url:"log-drains-item_url__9AxCM",deleteLogDrian:"log-drains-item_deleteLogDrian__ZwEd3"}},191042:function(e){e.exports={logDrainList:"log-drains-list_logDrainList__giXSy",logDrainsIntegrationList:"log-drains-list_logDrainsIntegrationList__FvIzN"}},112112:function(e){e.exports={modalTitle:"remove-log-drain-modal_modalTitle__Fej0M",errorMessage:"remove-log-drain-modal_errorMessage__shS_V"}},572009:function(e){e.exports={betaBadge:"beta-badge_betaBadge__nn52_",betaBadgeMuted:"beta-badge_betaBadgeMuted__VXlGg",feedbackButton:"beta-badge_feedbackButton__Q8_1M"}}}]);